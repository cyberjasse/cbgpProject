#GEANT
bgp add router 20965 4.0.0.1
bgp add router 20965 4.0.0.2
bgp add router 20965 4.0.0.3
bgp add router 20965 4.0.0.4

bgp router 4.0.0.1
	add network 4.0.0.0/24
	add peer 1 1.0.0.3
	add peer 1 1.0.0.4
	add peer 11537 3.0.0.1
	peer 1.0.0.3 next-hop-self
	peer 1.0.0.4 next-hop-self
	peer 3.0.0.1 next-hop-self
	peer 1.0.0.3 up
	peer 1.0.0.4 up
	peer 3.0.0.1 up
	add peer 20965 4.0.0.2
	peer 4.0.0.2 next-hop-self
	peer 4.0.0.2 up
	add peer 20965 4.0.0.3
	peer 4.0.0.3 next-hop-self
	peer 4.0.0.3 up
	add peer 20965 4.0.0.4
	peer 4.0.0.4 next-hop-self
	peer 4.0.0.4 up
	peer 1.0.0.3
		filter in
			add-rule 
				match any
				action "community add 1:3"
				exit
			exit
		exit
	peer 1.0.0.4
		filter in
			add-rule 
				match any
				action "community add 1:4"
				exit
			exit
		exit
	peer 3.0.0.1
		filter in
			add-rule 
				match any
				action "community add 11537:1"
				exit
			exit
		filter out
			add-rule 
				match "community is 1:3"
				action deny
				exit
			add-rule 
				match "community is 1:4"
				action deny
				exit
			add-rule 
				match "community is 1:1"
				action deny
				exit
			exit
		exit

bgp router 4.0.0.2
	add network 4.0.0.0/24
	add peer 1 1.0.0.1
	peer 1.0.0.1 next-hop-self
	peer 1.0.0.1
		filter in
			add-rule 
				match any
				action "community add 1:1"
				exit
			exit
		exit
	peer 1.0.0.1 up
	add peer 20965 4.0.0.1
	peer 4.0.0.1 next-hop-self
	peer 4.0.0.1 up
	add peer 20965 4.0.0.4
	peer 4.0.0.4 next-hop-self
	peer 4.0.0.4 up

bgp router 4.0.0.3
	add network 4.0.0.0/24
	add peer 2611 4.1.0.1
	add peer 11537 3.0.0.3
	add peer 201 4.200.0.1
	peer 4.1.0.1 next-hop-self
	peer 3.0.0.3 next-hop-self
	peer 4.200.0.1 next-hop-self
	peer 4.1.0.1 up
	peer 3.0.0.3 up
	peer 4.200.0.1 up
	add peer 20965 4.0.0.1
	peer 4.0.0.1 next-hop-self
	peer 4.0.0.1 up
	add peer 20965 4.0.0.4
	peer 4.0.0.4 next-hop-self
	peer 4.0.0.4 up
	peer 4.1.0.1
		filter out
			add-rule 
				match "community is 1:3"
				action deny
				exit
			add-rule 
				match "community is 1:4"
				action deny
				exit
			add-rule 
				match "community is 1:1"
				action deny
				exit
			exit
		exit
	peer 3.0.0.3
		filter out
			add-rule 
				match "community is 1:3"
				action deny
				exit
			add-rule 
				match "community is 1:4"
				action deny
				exit
			add-rule 
				match "community is 1:1"
				action deny
				exit
			exit
		exit

bgp router 4.0.0.4
	add network 4.0.0.0/24
	add peer 2611 4.1.0.2
	peer 4.1.0.2 next-hop-self
	peer 4.1.0.2 up
	add peer 20965 4.0.0.1
	peer 4.0.0.1 next-hop-self
	peer 4.0.0.1 up
	add peer 20965 4.0.0.2
	peer 4.0.0.2 next-hop-self
	peer 4.0.0.2 up
	add peer 20965 4.0.0.3
	peer 4.0.0.3 next-hop-self
	peer 4.0.0.3 up
	peer 4.1.0.2
		filter out
			add-rule 
				match "community is 1:3"
				action deny
				exit
			add-rule 
				match "community is 1:4"
				action deny
				exit
			add-rule 
				match "community is 1:1"
				action deny
				exit
		exit

